@prefix rdf:    <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs:   <http://www.w3.org/2000/01/rdf-schema#> .
@prefix xsd:    <http://www.w3.org/2001/XMLSchema#> .
@prefix owl:    <http://www.w3.org/2002/07/owl#> .
@prefix sh:     <http://www.w3.org/ns/shacl#> .
@prefix aerius: <http://example.org/graphs/aerius-extension#> .
@prefix nen:    <http://example.org/graphs/nen2660-ontology#> .
@prefix ex:     <http://example.org/shapes#> .

################################################################################
# EXTENDED SHACL SHAPES FOR AERIUS + NEN
# (Adjusted to match your RDF data exactly)
################################################################################

##########
# 1) ACTIVITY SHAPE
##########
ex:ActivityShape a sh:NodeShape ;
    sh:targetClass nen:Activity ;
    sh:description "Every NEN Activity must indicate at least one EmissionSource for nitrogen calc." ;
    sh:property [
        sh:path aerius:hasEmissionSource ;
        sh:minCount 1 ;
        sh:message "NEN Activity must have aerius:hasEmissionSource (minCount=1)."
    ] .

##########
# 2) CONSTRUCTION PROJECT SHAPE
#    (No year required, just label + at least 1 nen:Activity)
##########
ex:ConstructionProjectShape a sh:NodeShape ;
    sh:targetClass aerius:ConstructionProject ;
    sh:description "A ConstructionProject requires a label and at least one nen:Activity." ;
    sh:property [
        sh:path rdfs:label ;
        sh:minCount 1 ;
        sh:message "Must have rdfs:label (project name)."
    ] ;
    sh:property [
        sh:path aerius:includes ;
        sh:minCount 1 ;
        sh:message "Must include at least one nen:Activity."
    ] .

##########
# 3) MOBILE SOURCE SHAPE
#    (Accepts integer OR decimal for the emission values)
##########
ex:MobileSourceShape a sh:NodeShape ;
    sh:targetClass aerius:MobileSource ;
    sh:description "A MobileSource must have label, position, sector ID, emissions, and at least 1 SpecificMobileSource." ;

    # Label => string
    sh:property [
        sh:path aerius:mosolabel ;
        sh:datatype xsd:string ;
        sh:minCount 1 ;
        sh:message "Missing aerius:mosolabel for the mobile source."
    ] ;

    # Position => string
    sh:property [
        sh:path aerius:mosoposition ;
        sh:datatype xsd:string ;
        sh:minCount 1 ;
        sh:message "Missing aerius:mosoposition (string)."
    ] ;

    # Sector ID => string
    sh:property [
        sh:path aerius:sectorid ;
        sh:datatype xsd:string ;
        sh:minCount 1 ;
        sh:message "Missing aerius:sectorid (string)."
    ] ;

    # Emission fields => integer OR decimal
    # e.g. if user typed "1100"^^xsd:integer or "1100.0"^^xsd:decimal
    sh:property [
        sh:path aerius:emitsNH3 ;
        sh:minCount 1 ;
        sh:or (
            [ sh:datatype xsd:decimal ]
            [ sh:datatype xsd:integer ]
        ) ;
        sh:message "Must specify NH3 (integer or decimal)."
    ] ;
    sh:property [
        sh:path aerius:emitsNOX ;
        sh:minCount 1 ;
        sh:or (
            [ sh:datatype xsd:decimal ]
            [ sh:datatype xsd:integer ]
        ) ;
        sh:message "Must specify NOX (integer or decimal)."
    ] ;
    sh:property [
        sh:path aerius:emitsPM10 ;
        sh:minCount 1 ;
        sh:or (
            [ sh:datatype xsd:decimal ]
            [ sh:datatype xsd:integer ]
        ) ;
        sh:message "Must specify PM10 (integer or decimal)."
    ] ;
    sh:property [
        sh:path aerius:emitsNO2 ;
        sh:minCount 1 ;
        sh:or (
            [ sh:datatype xsd:decimal ]
            [ sh:datatype xsd:integer ]
        ) ;
        sh:message "Must specify NO2 (integer or decimal)."
    ] ;

    # Must link at least one SpecificMobileSource
    sh:property [
        sh:path aerius:hasSpecificMobileSource ;
        sh:minCount 1 ;
        sh:message "Must link at least one aerius:SpecificMobileSource."
    ] .

##########
# 4) SPECIFIC MOBILE SOURCE SHAPE
#    (Again, accept integer OR decimal for fuelyear)
##########
ex:SpecificMobileSourceShape a sh:NodeShape ;
    sh:targetClass aerius:SpecificMobileSource ;
    sh:description "A SpecificMobileSource must define mobtype, fuel usage, and a description." ;

    # mobtype => string
    sh:property [
        sh:path aerius:mobtype ;
        sh:datatype xsd:string ;
        sh:minCount 1 ;
        sh:message "Missing aerius:mobtype (string)."
    ] ;

    # fuelyear => integer OR decimal
    sh:property [
        sh:path aerius:fuelyear ;
        sh:minCount 1 ;
        sh:or (
            [ sh:datatype xsd:decimal ]
            [ sh:datatype xsd:integer ]
        ) ;
        sh:message "Missing aerius:fuelyear (integer or decimal)."
    ] ;

    # description => string
    sh:property [
        sh:path aerius:description ;
        sh:datatype xsd:string ;
        sh:minCount 1 ;
        sh:message "Missing aerius:description (string)."
    ] .
